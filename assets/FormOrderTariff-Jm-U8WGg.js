import{j as e,r as N}from"./react-Jw3Yv3Dx.js";import{g as V}from"./react-router-uND8Us2t.js";import{u as C,a as B,F as H}from"./react-hook-form-arUvvm_T.js";import{c as y}from"./classnames-TNdf9gv5.js";import{F as s,O as $,b as J,R as U,a as F}from"./react-bootstrap-c5_33dwq.js";import{R as X}from"./react-input-mask-XmBdG83Q.js";import{i as Y,m as z,a as K,R as Q,b as W,v as Z,p as ee,o as se}from"./index-fm04eBgn.js";import{S as te,u as re}from"./useActions-_Zm4KJCU.js";import{C as ae}from"./CityContext-Ieav2pYL.js";import{u as O}from"./useTypedSelector-OGXYHMc3.js";import{g as P}from"./tariffs-dW2RifDn.js";import{L as g}from"./react-router-dom-IHdWotJk.js";import"./@remix-run-R0A6g4pJ.js";import"./@restart-xIeF-cHV.js";import"./dom-helpers--nlGJCCs.js";import"./@react-aria-T7pU4Vz_.js";import"./react-dom-KmRZywdm.js";import"./scheduler-iwWdm5Ml.js";import"./dequal-vEqHzq4I.js";import"./@popperjs-u7bcf535.js";import"./warning-A3mB0AEe.js";import"./uncontrollable-af-_F5Rh.js";import"./@babel-o_ZSNJgm.js";import"./react-transition-group-XCMw5D4t.js";import"./prop-types-owtuOFwk.js";import"./react-redux-z09SlkWR.js";import"./use-sync-external-store-rpec4DOT.js";import"./framer-motion-g-r5ZHJ9.js";import"./react-helmet-async-zKePrVHr.js";import"./react-fast-compare-PQr6UfN5.js";import"./invariant-LDHjVc5t.js";import"./shallowequal-ujSgULk1.js";import"./@reduxjs-MlIXepis.js";import"./redux-C6JyQ450.js";import"./immer-2oJgyI5v.js";import"./reselect-lfPQZHtp.js";import"./redux-thunk-qyK_zz9Y.js";const le="_label_dg7fw_1",ie="_control_dg7fw_8",ne="_stepper_dg7fw_19",oe="_stepperItem_dg7fw_40",ce="_active_dg7fw_64",de="_labelCheck_dg7fw_72",me="_link_dg7fw_76",pe="_buttonNext_dg7fw_84",a={label:le,control:ie,stepper:ne,stepperItem:oe,active:ce,labelCheck:de,link:me,buttonNext:pe},xe=()=>{const{register:r,formState:{errors:t}}=C();return e.jsxs(e.Fragment,{children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Имя"}),e.jsx(s.Control,{type:"text",id:"first_name",placeholder:"Имя",className:a.control,...r("firstName",{required:!0,minLength:2})}),t.firstName&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, введите ваше имя"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Номер телефона"}),e.jsx(X,{id:"phone",type:"tel",className:y(a.control,"form-control"),mask:"+7(999) 999-99-99",alwaysShowMask:!0,...r("phone",{validate:{inputTelRequired:Y}})}),t.phone&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, введите ваш телефон"})]})]})},ue="_button_de7o2_1",he={button:ue};function be(){const r="Услуга не может быть оказана лицам моложе 14 лет",t=o=>e.jsx(J,{id:"button-tooltip",...o,children:r});return e.jsx($,{placement:"top",delay:{show:250,hide:400},overlay:t,children:e.jsx("button",{type:"button",className:he.button,"aria-label":r,children:e.jsx(te,{width:20,height:20})})})}const je=({data:r,item:t})=>{const o=z().toString(),c=K().toString(),b=N.useContext(ae),{tariffsActiveTab:x,clubsMC:u}=O(i=>i.price),j=b===Q.spb.name&&(x.toLocaleLowerCase()==="с бассейном"||t.type==="mc_full"),f=[];u.length>0&&f.push(P(u,["mc_full"]));const h=f.flat(1/0),{register:d,formState:{errors:l}}=C();return e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(F,{xs:12,sm:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Имя"}),e.jsx(s.Control,{type:"text",name:"first_name",placeholder:"Имя",id:"firstName",value:r.firstName,readOnly:!0,className:a.control})]})}),e.jsx(F,{xs:12,sm:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Фамилия"}),e.jsx(s.Control,{type:"text",placeholder:"Фамилия",className:a.control,id:"lastName",required:!0,...d("lastName",{required:!0,minLength:2})}),l.lastName&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, введите вашу фамилию"})]})})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Выберите клуб"}),j&&e.jsx("small",{className:"mb-1 d-flex",children:"Кроме клубов Фитнес Хаус Престиж (ул. Барочная, д.10/2Б, ул. Я. Гашека, 17А, Шереметьевская ул., 13А)"}),e.jsxs(s.Select,{"aria-label":"Выберите клуб",className:a.control,required:!0,...d("club_id",{required:!0}),children:[e.jsx("option",{value:"",children:"Выберете клуб"}),(t==null?void 0:t.clubs.length)>0&&t.type!=="mc_full"?[...t.clubs].map(i=>e.jsx("option",{value:i.id,children:i.address},i.address)):t.type==="mc_full"?[...h[0].clubs].map(i=>e.jsx("option",{value:i.id,children:i.address},i.address)):null]}),l.club_id&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, выберите клуб"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Номер телефона"}),e.jsx(s.Control,{type:"tel",name:"phone",className:a.control,id:"phone",value:r.phone,readOnly:!0})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsxs(s.Label,{className:a.label,children:["Дата рождения ",e.jsx(be,{})]}),e.jsx(s.Control,{type:"date",className:a.control,id:"customer_birth_day",min:c,max:o,required:!0,...d("birth_day",{required:!0,min:c,max:o,validate:{inputBirthDayRequired:W}})}),l.birth_day&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, введите вашу дату рождения"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{className:a.label,children:"Email"}),e.jsx(s.Control,{type:"email",placeholder:"Email",className:a.control,id:"email",required:!0,...d("email",{required:!0,validate:{inputEmailRequired:Z}})}),l.email&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, введите ваш email"})]})]})},fe="_list_u80dj_1",Ne="_item_u80dj_8",_e="_text_u80dj_15",ye="_price_u80dj_20",p={list:fe,item:Ne,text:_e,price:ye},ge=({price:r,club:t})=>{const o=t.first_pay[0]!==void 0?t.first_pay[0].product_price:0,c=+r+ +o;return e.jsxs("div",{className:"py-2 p-sm-2",children:[e.jsxs("ul",{className:p.list,children:[e.jsxs("li",{className:p.item,children:[e.jsx("span",{children:"Стоимость тарифа"}),e.jsxs("span",{className:p.price,children:[e.jsx("b",{children:r})," ",e.jsx("small",{children:"₽"})]})]}),e.jsxs("li",{className:p.item,children:[e.jsx("span",{children:"Первоначальный платеж"}),e.jsxs("span",{className:p.price,children:[e.jsx("b",{children:o})," ",e.jsx("small",{children:"₽"})]})]}),e.jsxs("li",{className:p.item,children:[e.jsxs("span",{children:[e.jsx("b",{children:"Итого:"}),e.jsx("br",{}),"к оплате за первый месяц"]}),e.jsxs("span",{className:p.price,children:[e.jsx("b",{children:c})," ",e.jsx("small",{children:"₽"})]})]})]}),e.jsxs("p",{className:p.text,children:["Ежемесячное списание Подписки со второго месяца будет равно стоимости Вашего тарифа ",r," ₽"]})]})};function Ce({price:r,club:t}){return e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ge,{price:r,club:t})})}const Te=()=>{const{register:r,formState:{errors:t}}=C();return e.jsx(e.Fragment,{children:e.jsxs(s.Check,{type:"checkbox",id:"checkbox",children:[e.jsx(s.Check.Input,{type:"checkbox",...r("isCheck",{required:!0})}),e.jsxs(s.Check.Label,{className:a.labelCheck,children:["Я ознакомлен(-на) и согласен(-на) с условиями"," ",e.jsx(g,{to:"/",className:a.link,target:"_blank",rel:"noreferrer",children:"Договора Оферты"}),","," ",e.jsx(g,{to:"/",className:a.link,target:"_blank",rel:"noreferrer",children:"Правилами Клуба"})," ","и даю своё согласие на"," ",e.jsx(g,{to:"/",className:a.link,target:"_blank",rel:"noreferrer",children:"обработку персональных данных"}),"."]}),t.isCheck&&e.jsx(s.Text,{className:"text-danger",children:"Пожалуйста, заполните поле"})]})})},q=new Headers;q.append("Content-Type","application/json");const ke=ee.injectEndpoints({endpoints:r=>({createOrder:r.mutation({query:t=>({headers:q,redirect:"follow",url:window.location.hostname==="localhost"?"http://127.0.0.1:8000/payments/orders/":window.location.origin+"/payments/orders/",method:"POST",body:JSON.stringify(t)}),extraOptions:{maxRetries:1},transformResponse:t=>t.body})}),overrideExisting:!1}),{useCreateOrderMutation:Se}=ke,D={firstName:"",lastName:"",phone:"",email:"",birth_day:"",club_id:"",isCheck:!1},ve=({item:r})=>{const t=N.useRef(null),[o,c]=N.useState(!1),{getProductsPosition:b,getClubsPositions:x,getProductsPositionFirstPay:u,getFormData:j,getCustomer:f}=re(),[h]=Se(),d=[1,2,3],[l,i]=N.useState(1),[m,T]=N.useState(D),k=B({mode:"all"}),{formState:{isValid:S,isDirty:I},watch:_,reset:E}=k,R=()=>{i(n=>n+1)},G=n=>{n=_(),T(n),R(),j(_())},v=n=>{var w;(w=t==null?void 0:t.current)==null||w.addEventListener("click",()=>{var L;return(L=t==null?void 0:t.current)==null?void 0:L.setAttribute("disabled","true")}),n=_(),j(_()),f(),x(r.clubs),b(r),u(n.club_id),c(!0);const M=se(m,n,r);h({body:M}),E(),T(D),i(3),c(!1)},A=()=>l>2?null:l===2?e.jsx("button",{type:"button",className:y(a.buttonNext,"w-100 my-2 mb-4 p-3"),onClick:v,disabled:!S||!I,ref:t,children:"Оплатить"}):e.jsx("button",{type:"button",onClick:G,className:y(a.buttonNext,"w-100 my-2 mb-4 p-3"),disabled:!S,children:"Вперед"});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:a.stepper,children:d.map(n=>e.jsx("div",{className:n<=l?y(a.stepperItem,a.active):a.stepperItem,children:e.jsx("span",{children:n})},n))}),e.jsx(H,{...k,children:e.jsxs(s,{noValidate:!0,validated:o,onSubmit:v,children:[l>=1&&e.jsx("div",{className:l===1?"":"d-none",children:e.jsx(xe,{})}),l>=2&&e.jsx("div",{className:l===2?"":"d-none",children:e.jsx(je,{data:m,item:r})}),l>=2&&e.jsx("div",{className:l===2?"":"d-none",children:e.jsx(Ce,{price:r.price,club:r.clubs[0]})}),A(),l<=2&&e.jsx("div",{className:l===2||l===1?"":"d-none",children:e.jsx(Te,{})})]})})]})},ms=()=>{var i;const r=V(),{clubsPoolYes:t,clubsPoolNo:o,clubsPremiere:c,tariffTypes:b,tariffsTabs:x,tariffsActiveTab:u}=O(m=>m.price),h=[{tab:x[0],list:c},{tab:x[1],list:t},{tab:x[2],list:o}].filter(m=>m.tab===u)[0].list,d=[];h.length>0&&d.push(P(h,b));const l=(i=d.flat(1))==null?void 0:i.find(m=>m.id===Number(r.id));return e.jsx(ve,{item:l})};export{ms as default};
